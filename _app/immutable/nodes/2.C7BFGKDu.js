var ue=Object.defineProperty;var fe=(l,t,e)=>t in l?ue(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var j=(l,t,e)=>fe(l,typeof t!="symbol"?t+"":t,e);import{s as W,c as le,i as ce,u as se,g as re,a as oe,x as ne,r as J,e as ae,y as me,o as he,z as de,b as _e}from"../chunks/scheduler.DenaoY1X.js";import{S as R,i as q,e as b,c as w,d as v,g as c,o as $,p as k,j as d,y as C,t as P,a as I,k as M,z as Ee,u as D,s as T,v as F,h as O,w as B,x as V,A as pe,B as g,b as S,f as K,C as ge,D as be,n as we,q as ve}from"../chunks/index.CEffbTBO.js";import{w as $e}from"../chunks/index.BiLioCNa.js";function A(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}let U=$e(!1);function G(l){return{is_present:!0,value:l}}function Q(){return{is_present:!1}}async function ke(l){return new Promise(t=>{setTimeout(t,l)})}function Pe(l){let t=[],e=l.board.at(0);for(let o=0;o<e.length;++o)e.at(o).type==="Empty"&&t.push(o);if(t.length===0)return Q();let s=Math.trunc(Math.random()*t.length);return G(t.at(s))}async function Y(l){let t=Pe(l);if(!t.is_present)return Q();await ke(200+Math.random()*800);let e=l.play(t.value);if(!e.is_ok){if(e.error==="GameIsOver")throw new Error("Bot shouldn't be told to play because we checked earlier for playable columns");if(e.error==="ColumnOutOfBounds")throw new Error("Bot shouldn't be told to play because we checked earlier for playable columns");if(e.error==="ColumnIsFull")throw new Error("Bot shouldn't be told to play because we checked earlier for playable columns")}return G(void 0)}function ie(l){const t=e=>{l.contains(e.target)||l.dispatchEvent(new CustomEvent("clickoutside"))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Ie(l){return{is_ok:!0,value:l}}function H(l){return{is_ok:!1,error:l}}class Te{constructor(){j(this,"board_");j(this,"state_");this.state_={type:"PlayerTurn",player:"Player1"},this.board_=[[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}]]}get board(){return this.board_}get state(){return this.state_}restart(){this.state_={type:"PlayerTurn",player:"Player1"},this.board_=[[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}],[{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"},{type:"Empty"}]]}play(t){if(this.state_.type==="GameIsOver")return H("GameIsOver");if(t<0||this.width<=t)return H("ColumnOutOfBounds");if(this.board_.at(0).at(t).type!=="Empty")return H("ColumnIsFull");for(let o=this.height-1;0<=o;--o)if(this.board_.at(o).at(t).type==="Empty"){this.state_.player==="Player1"?(this.board_[o][t]={type:"Filled",player:"Player1"},this.state_={type:"PlayerTurn",player:"Player2",previous:this.board_[o][t]}):(this.board_[o][t]={type:"Filled",player:"Player2"},this.state_={type:"PlayerTurn",player:"Player1",previous:this.board_[o][t]});break}let s=this.checkWinner;return s.is_present&&(this.state_={type:"GameIsOver",outcome:s.value}),Ie(void 0)}get checkWinner(){for(let e=0;e<this.height;++e)for(let s=0;s<this.width-3;++s){const o=this.board_[e][s+0],n=this.board_[e][s+1],a=this.board_[e][s+2],r=this.board_[e][s+3];if(o.type!=="Empty"&&n.type!=="Empty"&&a.type!=="Empty"&&r.type!=="Empty"&&o.player===n.player&&o.player===a.player&&o.player===r.player)return G(o.player==="Player1"?{type:"PlayerOneWon",cells:[o,n,a,r]}:{type:"PlayerTwoWon",cells:[o,n,a,r]})}for(let e=0;e<this.height-3;++e)for(let s=0;s<this.width;++s){const o=this.board_[e+0][s],n=this.board_[e+1][s],a=this.board_[e+2][s],r=this.board_[e+3][s];if(o.type!=="Empty"&&n.type!=="Empty"&&a.type!=="Empty"&&r.type!=="Empty"&&o.player===n.player&&o.player===a.player&&o.player===r.player)return G(o.player==="Player1"?{type:"PlayerOneWon",cells:[o,n,a,r]}:{type:"PlayerTwoWon",cells:[o,n,a,r]})}for(let e=0;e<this.height-3;++e)for(let s=0;s<this.width-3;++s){const o=this.board_[e+0][s+0],n=this.board_[e+1][s+1],a=this.board_[e+2][s+2],r=this.board_[e+3][s+3];if(o.type!=="Empty"&&n.type!=="Empty"&&a.type!=="Empty"&&r.type!=="Empty"&&o.player===n.player&&o.player===a.player&&o.player===r.player)return G(o.player==="Player1"?{type:"PlayerOneWon",cells:[o,n,a,r]}:{type:"PlayerTwoWon",cells:[o,n,a,r]})}for(let e=0;e<this.height-3;++e)for(let s=3;s<this.width;++s){const o=this.board_[e+0][s-0],n=this.board_[e+1][s-1],a=this.board_[e+2][s-2],r=this.board_[e+3][s-3];if(o.type!=="Empty"&&n.type!=="Empty"&&a.type!=="Empty"&&r.type!=="Empty"&&o.player===n.player&&o.player===a.player&&o.player===r.player)return G(o.player==="Player1"?{type:"PlayerOneWon",cells:[o,n,a,r]}:{type:"PlayerTwoWon",cells:[o,n,a,r]})}return this.board_.every(e=>e.every(s=>s.type!=="Empty"))?G({type:"Tie"}):Q()}get height(){return this.board_.length}get width(){return this.board_.at(0).length}}function Oe(l){let t,e,s,o;const n=l[3].default,a=le(n,l,l[2],null);return{c(){t=b("button"),a&&a.c(),this.h()},l(r){t=w(r,"BUTTON",{class:!0});var y=v(t);a&&a.l(y),y.forEach(c),this.h()},h(){$(t,"class","svelte-zo66y0"),k(t,"font-size",l[0])},m(r,y){d(r,t,y),a&&a.m(t,null),e=!0,s||(o=C(t,"click",function(){ce(l[1])&&l[1].apply(this,arguments)}),s=!0)},p(r,[y]){l=r,a&&a.p&&(!e||y&4)&&se(a,n,l,l[2],e?oe(n,l[2],y,null):re(l[2]),null),y&1&&k(t,"font-size",l[0])},i(r){e||(P(a,r),e=!0)},o(r){I(a,r),e=!1},d(r){r&&c(t),a&&a.d(r),s=!1,o()}}}function Me(l,t,e){let{$$slots:s={},$$scope:o}=t,{fontSize:n="6vh"}=t,{action:a}=t;return l.$$set=r=>{"fontSize"in r&&e(0,n=r.fontSize),"action"in r&&e(1,a=r.action),"$$scope"in r&&e(2,o=r.$$scope)},[n,a,o,s]}class L extends R{constructor(t){super(),q(this,t,Me,Oe,W,{fontSize:0,action:1})}}function Ce(l){let t,e,s,o,n;const a=l[3].default,r=le(a,l,l[2],null);return{c(){t=b("dialog"),e=b("div"),r&&r.c(),this.h()},l(y){t=w(y,"DIALOG",{class:!0});var u=v(t);e=w(u,"DIV",{class:!0});var f=v(e);r&&r.l(f),f.forEach(c),u.forEach(c),this.h()},h(){$(e,"class","center-content"),$(t,"class","svelte-153faf1")},m(y,u){d(y,t,u),M(t,e),r&&r.m(e,null),l[5](t),s=!0,o||(n=[ne(ie.call(null,e)),C(e,"clickoutside",l[4]),C(t,"close",l[6])],o=!0)},p(y,[u]){r&&r.p&&(!s||u&4)&&se(r,a,y,y[2],s?oe(a,y[2],u,null):re(y[2]),null)},i(y){s||(P(r,y),s=!0)},o(y){I(r,y),s=!1},d(y){y&&c(t),r&&r.d(y),l[5](null),o=!1,J(n)}}}function Ge(l,t,e){let{$$slots:s={},$$scope:o}=t,{showModal:n}=t,a;const r=()=>e(0,n=!1);function y(f){ae[f?"unshift":"push"](()=>{a=f,e(1,a)})}const u=()=>e(0,n=!1);return l.$$set=f=>{"showModal"in f&&e(0,n=f.showModal),"$$scope"in f&&e(2,o=f.$$scope)},l.$$.update=()=>{l.$$.dirty&3&&a&&n&&a.showModal(),l.$$.dirty&3&&a&&!n&&a.close()},[n,a,o,s,r,y,u]}class De extends R{constructor(t){super(),q(this,t,Ge,Ce,W,{showModal:0})}}function Z(l,t,e){const s=l.slice();return s[17]=t[e],s[19]=e,s}function x(l,t,e){const s=l.slice();return s[20]=t[e],s[22]=e,s}function Fe(l){let t;return{c(){t=S("Resume")},l(e){t=K(e,"Resume")},m(e,s){d(e,t,s)},d(e){e&&c(t)}}}function Be(l){let t;return{c(){t=S("Restart")},l(e){t=K(e,"Restart")},m(e,s){d(e,t,s)},d(e){e&&c(t)}}}function Ve(l){let t;return{c(){t=S("Return to menu")},l(e){t=K(e,"Return to menu")},m(e,s){d(e,t,s)},d(e){e&&c(t)}}}function ze(l){let t,e,s,o,n,a,r,y,u,f;return t=new L({props:{action:l[6],$$slots:{default:[Fe]},$$scope:{ctx:l}}}),n=new L({props:{action:l[4],$$slots:{default:[Be]},$$scope:{ctx:l}}}),u=new L({props:{action:l[7],$$slots:{default:[Ve]},$$scope:{ctx:l}}}),{c(){D(t.$$.fragment),e=T(),s=b("div"),o=T(),D(n.$$.fragment),a=T(),r=b("div"),y=T(),D(u.$$.fragment),this.h()},l(p){F(t.$$.fragment,p),e=O(p),s=w(p,"DIV",{class:!0}),v(s).forEach(c),o=O(p),F(n.$$.fragment,p),a=O(p),r=w(p,"DIV",{class:!0}),v(r).forEach(c),y=O(p),F(u.$$.fragment,p),this.h()},h(){$(s,"class","svelte-19aa99q"),k(s,"height","12vh"),$(r,"class","svelte-19aa99q"),k(r,"height","12vh")},m(p,i){B(t,p,i),d(p,e,i),d(p,s,i),d(p,o,i),B(n,p,i),d(p,a,i),d(p,r,i),d(p,y,i),B(u,p,i),f=!0},p(p,i){const m={};i&8&&(m.action=p[6]),i&8388608&&(m.$$scope={dirty:i,ctx:p}),t.$set(m);const _={};i&8388608&&(_.$$scope={dirty:i,ctx:p}),n.$set(_);const E={};i&8388608&&(E.$$scope={dirty:i,ctx:p}),u.$set(E)},i(p){f||(P(t.$$.fragment,p),P(n.$$.fragment,p),P(u.$$.fragment,p),f=!0)},o(p){I(t.$$.fragment,p),I(n.$$.fragment,p),I(u.$$.fragment,p),f=!1},d(p){p&&(c(e),c(s),c(o),c(a),c(r),c(y)),V(t,p),V(n,p),V(u,p)}}}function ee(l){let t,e,s,o;function n(){return l[10](l[22])}function a(){return l[11](l[22])}return{c(){t=b("div"),e=b("div"),this.h()},l(r){t=w(r,"DIV",{role:!0,tabindex:!0,class:!0});var y=v(t);e=w(y,"DIV",{class:!0}),v(e).forEach(c),y.forEach(c),this.h()},h(){$(e,"class","cell svelte-19aa99q"),g(e,"preview",l[20].type==="Empty"&&l[0].state.type==="PlayerTurn"&&l[0].state.player===l[1]&&l[2]===l[22]),g(e,"filled",l[20].type==="Filled"),g(e,"player-one",l[20].type==="Filled"&&l[20].player==="Player1"),g(e,"player-two",l[20].type==="Filled"&&l[20].player==="Player2"),g(e,"previous",l[0].state.type==="PlayerTurn"&&l[0].state.previous===l[20]),g(e,"highlighted",l[0].state.type==="GameIsOver"&&l[0].state.outcome.type!=="Tie"&&l[0].state.outcome.cells.includes(l[20])),g(e,"decolored",l[0].state.type==="GameIsOver"&&l[0].state.outcome.type==="Tie"||l[0].state.type==="GameIsOver"&&l[0].state.outcome.type!=="Tie"&&(l[20].type==="Empty"||l[20].type==="Filled"&&!l[0].state.outcome.cells.includes(l[20]))),k(e,"--current-player",l[0].state.type==="PlayerTurn"&&l[0].state.player==="Player1"?"red":l[0].state.type==="PlayerTurn"&&l[0].state.player==="Player2"?"darkgoldenrod":""),k(e,"transition",l[0].state.type==="GameIsOver"?"background-color 200ms, filter 200ms":""),$(t,"role","cell"),$(t,"tabindex",l[19]),$(t,"class","svelte-19aa99q")},m(r,y){d(r,t,y),M(t,e),s||(o=[C(t,"click",l[9]),C(t,"keydown",Re),C(t,"mouseover",n),C(t,"focus",a)],s=!0)},p(r,y){l=r,y&7&&g(e,"preview",l[20].type==="Empty"&&l[0].state.type==="PlayerTurn"&&l[0].state.player===l[1]&&l[2]===l[22]),y&1&&g(e,"filled",l[20].type==="Filled"),y&1&&g(e,"player-one",l[20].type==="Filled"&&l[20].player==="Player1"),y&1&&g(e,"player-two",l[20].type==="Filled"&&l[20].player==="Player2"),y&1&&g(e,"previous",l[0].state.type==="PlayerTurn"&&l[0].state.previous===l[20]),y&1&&g(e,"highlighted",l[0].state.type==="GameIsOver"&&l[0].state.outcome.type!=="Tie"&&l[0].state.outcome.cells.includes(l[20])),y&1&&g(e,"decolored",l[0].state.type==="GameIsOver"&&l[0].state.outcome.type==="Tie"||l[0].state.type==="GameIsOver"&&l[0].state.outcome.type!=="Tie"&&(l[20].type==="Empty"||l[20].type==="Filled"&&!l[0].state.outcome.cells.includes(l[20]))),y&1&&k(e,"--current-player",l[0].state.type==="PlayerTurn"&&l[0].state.player==="Player1"?"red":l[0].state.type==="PlayerTurn"&&l[0].state.player==="Player2"?"darkgoldenrod":""),y&1&&k(e,"transition",l[0].state.type==="GameIsOver"?"background-color 200ms, filter 200ms":"")},d(r){r&&c(t),s=!1,J(o)}}}function te(l){let t,e,s=A(l[17]),o=[];for(let n=0;n<s.length;n+=1)o[n]=ee(x(l,s,n));return{c(){t=b("div");for(let n=0;n<o.length;n+=1)o[n].c();e=T(),this.h()},l(n){t=w(n,"DIV",{class:!0});var a=v(t);for(let r=0;r<o.length;r+=1)o[r].l(a);e=O(a),a.forEach(c),this.h()},h(){$(t,"class","row svelte-19aa99q")},m(n,a){d(n,t,a);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(t,null);M(t,e)},p(n,a){if(a&39){s=A(n[17]);let r;for(r=0;r<s.length;r+=1){const y=x(n,s,r);o[r]?o[r].p(y,a):(o[r]=ee(y),o[r].c(),o[r].m(t,e))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},d(n){n&&c(t),pe(o,n)}}}function We(l){let t,e,s,o,n,a,r;function y(i){l[8](i)}let u={$$slots:{default:[ze]},$$scope:{ctx:l}};l[3]!==void 0&&(u.showModal=l[3]),t=new De({props:u}),ae.push(()=>Ee(t,"showModal",y));let f=A(l[0].board),p=[];for(let i=0;i<f.length;i+=1)p[i]=te(Z(l,f,i));return{c(){D(t.$$.fragment),s=T(),o=b("div");for(let i=0;i<p.length;i+=1)p[i].c();this.h()},l(i){F(t.$$.fragment,i),s=O(i),o=w(i,"DIV",{class:!0});var m=v(o);for(let _=0;_<p.length;_+=1)p[_].l(m);m.forEach(c),this.h()},h(){$(o,"class","svelte-19aa99q")},m(i,m){B(t,i,m),d(i,s,m),d(i,o,m);for(let _=0;_<p.length;_+=1)p[_]&&p[_].m(o,null);n=!0,a||(r=[ne(ie.call(null,o)),C(o,"clickoutside",l[12])],a=!0)},p(i,[m]){const _={};if(m&8388616&&(_.$$scope={dirty:m,ctx:i}),!e&&m&8&&(e=!0,_.showModal=i[3],me(()=>e=!1)),t.$set(_),m&39){f=A(i[0].board);let E;for(E=0;E<f.length;E+=1){const N=Z(i,f,E);p[E]?p[E].p(N,m):(p[E]=te(N),p[E].c(),p[E].m(o,null))}for(;E<p.length;E+=1)p[E].d(1);p.length=f.length}},i(i){n||(P(t.$$.fragment,i),n=!0)},o(i){I(t.$$.fragment,i),n=!1},d(i){i&&(c(s),c(o)),V(t,i),pe(p,i),a=!1,J(r)}}}const Re=()=>{};function qe(l,t,e){let s=new Te,o,n,a=0,r=!1;async function y(){if(Math.random()>.5?(e(1,o="Player1"),n="Player2"):(e(1,o="Player2"),n="Player1"),n==="Player1"){if(!(await Y(s)).is_present)throw new Error("Bot should be able to play because it starts first");e(0,s)}}function u(){e(3,r=!1),s.restart(),y(),e(0,s)}async function f(h){if(s.state.type==="PlayerTurn"&&s.state.player!==o)return;let z=s.play(h);if(!z.is_ok){if(z.error==="GameIsOver")return;if(z.error==="ColumnOutOfBounds")return;if(z.error==="ColumnIsFull")return}if(e(0,s),s.state.type==="GameIsOver")return;if(!(await Y(s)).is_present)throw new Error("Bot shouldn't play because we checked if the game was over");e(0,s)}function p(h){let z=h.key==="ArrowLeft"||h.code==="KeyJ",X=h.key==="ArrowRight"||h.code==="KeyL",ye=h.key==="ArrowDown"||h.key==="Enter"||h.key===" "||h.code==="KeyK";h.key==="Escape"?(h.preventDefault(),e(3,r=!r)):z?a>0&&e(2,a--,a):X?a<s.width-1&&e(2,a++,a):ye&&f(a)}function i(h){p(h)}he(()=>{y(),document.addEventListener("keydown",i)}),de(()=>{document.removeEventListener("keydown",i)});const m=()=>e(3,r=!1),_=()=>U.set(!1);function E(h){r=h,e(3,r)}return[s,o,a,r,u,f,m,_,E,()=>f(a),h=>e(2,a=h),h=>e(2,a=h),()=>e(3,r=!0)]}class Le extends R{constructor(t){super(),q(this,t,qe,We,W,{})}}function Ae(l){let t;return{c(){t=S("Play")},l(e){t=K(e,"Play")},m(e,s){d(e,t,s)},d(e){e&&c(t)}}}function Se(l){let t,e,s="Connect Four",o,n,a,r,y,u,f;return r=new L({props:{action:l[0],$$slots:{default:[Ae]},$$scope:{ctx:l}}}),{c(){t=b("div"),e=b("h1"),e.textContent=s,o=T(),n=b("div"),a=T(),D(r.$$.fragment),y=T(),u=b("div"),this.h()},l(p){t=w(p,"DIV",{});var i=v(t);e=w(i,"H1",{"data-svelte-h":!0}),ge(e)!=="svelte-sp08iw"&&(e.textContent=s),o=O(i),n=w(i,"DIV",{}),v(n).forEach(c),a=O(i),F(r.$$.fragment,i),y=O(i),u=w(i,"DIV",{}),v(u).forEach(c),i.forEach(c),this.h()},h(){k(e,"font-size","10vh"),k(n,"height","12vh"),k(u,"height","12vh"),k(t,"text-align","center")},m(p,i){d(p,t,i),M(t,e),M(t,o),M(t,n),M(t,a),B(r,t,null),M(t,y),M(t,u),f=!0},p(p,[i]){const m={};i&2&&(m.$$scope={dirty:i,ctx:p}),r.$set(m)},i(p){f||(P(r.$$.fragment,p),f=!0)},o(p){I(r.$$.fragment,p),f=!1},d(p){p&&c(t),V(r)}}}function Ke(l){return[()=>U.set(!0)]}class Ne extends R{constructor(t){super(),q(this,t,Ke,Se,W,{})}}function je(l){let t,e;return t=new Ne({}),{c(){D(t.$$.fragment)},l(s){F(t.$$.fragment,s)},m(s,o){B(t,s,o),e=!0},i(s){e||(P(t.$$.fragment,s),e=!0)},o(s){I(t.$$.fragment,s),e=!1},d(s){V(t,s)}}}function He(l){let t,e;return t=new Le({}),{c(){D(t.$$.fragment)},l(s){F(t.$$.fragment,s)},m(s,o){B(t,s,o),e=!0},i(s){e||(P(t.$$.fragment,s),e=!0)},o(s){I(t.$$.fragment,s),e=!1},d(s){V(t,s)}}}function Je(l){let t,e,s,o,n;const a=[He,je],r=[];function y(u,f){return u[0]?0:1}return s=y(l),o=r[s]=a[s](l),{c(){t=T(),e=b("div"),o.c(),this.h()},l(u){be("svelte-1x847kb",document.head).forEach(c),t=O(u),e=w(u,"DIV",{class:!0});var p=v(e);o.l(p),p.forEach(c),this.h()},h(){document.title="Connect Four",$(e,"class","center-content")},m(u,f){d(u,t,f),d(u,e,f),r[s].m(e,null),n=!0},p(u,[f]){let p=s;s=y(u),s!==p&&(ve(),I(r[p],1,1,()=>{r[p]=null}),we(),o=r[s],o||(o=r[s]=a[s](u),o.c()),P(o,1),o.m(e,null))},i(u){n||(P(o),n=!0)},o(u){I(o),n=!1},d(u){u&&(c(t),c(e)),r[s].d()}}}function Ue(l,t,e){let s;return _e(l,U,o=>e(0,s=o)),[s]}class st extends R{constructor(t){super(),q(this,t,Ue,Je,W,{})}}export{st as component};
